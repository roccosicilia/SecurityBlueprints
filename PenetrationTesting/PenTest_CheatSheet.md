# PenTest Cheat Sheet [last update 09/2024]

Table of contents
- [Recon](#Recon)
- [Vulnerability Scan](#Vulnerability-Scan)
- [Web Application Security](#Web-Application-Security)


## Recon

Information Gathering, search engine:
| Search Engine         | Description                       |
|-----------------------|-----------------------------------|
| https://google.com    | Info about company, people, contacts, other domain, media info, external services, projects. |
| https://yandex.com    | Search by images                  |
| https://stract.com    | Community, forums, blogs          |
| https://github.com    |                                   |
| https://gist.github.com   |                               |
| https://about.gitlab.com  |                               |
| https://sourceforge.net   |                               |

DNS Enumeration web-tools:
| Tool                              | Description                       |
|-----------------------------------|-----------------------------------|
| https://searchdns.netcraft.com    |                                   |
| https://dnsdumpster.com           |                                   |
| https://shodan.io                 | Info about technologies, subnet, service, vuls, service provider, technical informations. |
| https://search.censys.io          |                                   |
| https://securityheaders.com       |                                   |

Domain Information:
``` bash
# DNS query
host $TARGET_DOMAIN
host -C $TARGET_DOMAIN
host -t MX $TARGET_DOMAIN   ## MX record details
host -t TXT $TARGET_DOMAIN  ## TXT record details
dig MX $TARGET_DOMAIN
dig TXT $TARGET_DOMAIN

# whois query
whois $TARGET_DOMAIN
whois $TARGET_DOMAIN -h $WHOIS_SERVER_IP
```

Subdomain Discovery:
``` bash
fierce --domain $TARGET_DOMAIN --dns-server $DNS_SERVER_IP
dnsenum $TARGET_DOMAIN
dnsrecon $TARGET_DOMAIN
gobuster vhost -w $WORDLIST -u $TARGET_DOMAIN
```

HOST Discovery and PORT Scan:
``` bash
# host discovery script via ICMP request
NET="192.168.0";    ## change me
for (( i=1; i<=254; i+=1 )); IP=$(ping -c1 -W1 $NET.$i | grep -B1 " 0%" | grep ping | awk '{print $2}') && HOSTNAME=$(nslookup $NET.$i | grep net | awk '{print $4}') && echo "| $IP\t| $HOSTNAME\t|" | grep ".$i" | grep $NET
```

``` powershell
# host discovery (via powershell)
Test-NetConnection -ComputerName $TARGET_IP -Port $PORT
Test-Connection -ComputerName $TARGET_IP -TcpPort $PORT -Count 1
```

``` bash
# post scan
nc -nvv -w 1 -z $TARGET_HOST $START_PORT-$END_PORT      ## NETCAT tcp scan
nc -nvv -u -w 1 -z $TARGET_HOST $START_PORT-$END_PORT   ## NETCAT udp scan
nmap -sT -p- $TARGET_IP                 ## tcp scan, all port
nmap -sS -p- $TARGET_IP                 ## syn scan, all port
nmap -sC -p- $TARGET_IP                 ## script default, all port
nmap -sT -p- --script vuln $TARGET_IP   ## vuln script, all port
nmap -sT -p- --script all $TARGET_IP    ## all script, all port
```

Services Discovery:
``` bash
nmap -v -p 139,445 --script smb-os-discovery $TARGET_NET    ## 192.168.1.0-254
sudo nbtscan -r $TARGET_NET                                 ## 192.168.1.0/24
sudo smbmap -H $TARGET_IP                                   ## smb scan
net view \\$HOSTNAME /all                                   ## smb host in a microsoft domain
smbclient -L //$TARGET_IP                                   ## share list
smbclient //$TARGET_IP/$SHARE -U "$USER" --password="$PASS" ## access to a share

sudo nmap -sU --open -p 161 $TARGET_NET                     ## SNMP host via NMAP
onesixtyone -c 192.168.0.0/24 public                        ## find SNMP hosts
onesixtyone -c $COMMUNITY_LIST -i $IP_LIST                  ## list of community and target
snmpwalk -c $COMMUNITY -v1 -t 10 $TARGET_IP
```

## Vulnerability Scan

Base scan tools:
``` bash
sudp nmap -sT -p- $TARGET_IP                                ## check open port
sudo nmap -sT --script all $TARGET_IP -p $PORT,$PORT,...    ## all script
sudo nmap -sT --script vuln $TARGET_IP -p $PORT,$PORT,...   ## vuln script
nikto -h http://$TARGET_IP                                  ## webapp vuln scan
```

Metaspoit scan module:
``` bash
search type:auxiliary scanner                               ## list of scanner modules
use auxiliary/scanner/smb/smb_version                       ## example: user smb scan module
set RHOST $TARGET_IP                                        ## configure target host for scan module
run                                                         ## start the scan task
vulns                                                       ## vulns list (if available)
```

## Web Application Security

Get information and scan:
``` bash
sudo nmap -p80,443 --script=http-enum $TARGET_IP            ## http enum for HTTP port only
sudo nmap -p80,443 --script=http-enum --script-args http-enum.basepath="$PATH" $TARGET_IP
```